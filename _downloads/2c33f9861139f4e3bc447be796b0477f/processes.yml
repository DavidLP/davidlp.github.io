# Process parameters are defined here. Sites might overwrite these partially (e.g. for higher rate).

Shipping:
   model: simple
   delay: 5  # days

FE wafer production:
   output:
      Itkpix wafer: 25  # output in lots of 25 wafers
   rate:
      - 01.04.2020: 3  # 10% pre-production order (lot 1-3)
      - 01.10.2020: 28  # 90% main order (lot 4-28)
      
Sensor wafer production:
   output:
      Sensor wafer 3D 50 50, Sensor wafer 3D 25 100, Sensor wafer planar: 5

Quad hybrid production:
   output: Common quad hybrid
   rate:
      - 01.04.2020: 1
      - 01.10.2020: 1
   
Triplet hybrid stave production:
   output: Hybrid l0 stave
   
Triplet hybrid rings production:
   output: Hybrid l0 coupled rings
   
Triplet hybrid endcap production:
   output: Hybrid l0 endcap

FE wafer probing:  # name of the process
   input: Itkpix wafer  # input parts required for process
   output: Itkpix wafer tested  # output parts from process
   rate:  # throuput for the process (parts per time)
      per run: 48h  # average rate; per wafer probing run 48h
      
# Redistribution:
#    input:
#       - itkpix wafer  # input definition via part name
#       - sensor, wafer  # input definition via part attributes
#    output:
#       - itkpix wafer
#       - sensor, wafer

FE wafer post processing:  # Bump deposition + Dicing and thinning
   input: Itkpix wafer tested
   output:
      Itkpix chip tested: 127
   yield: 95% * 95%  # Bump deposition yield * Dicing and thinning yield

FE selection:
   input: Itkpix chip tested
   output: Itkpix chip passed
   yield: 61% * 99.9%  # FE chip wafer FE yield * Losses due to wafer probing
      
Sensor wafer post processing:  # UBM deposition + Dicing (thinning)
   input: Sensor wafer 3D 50 50, Sensor wafer 3D 25 100, Sensor wafer planar, Sensor wafer planar
   output: Sensor 3D 50 50, Sensor 3D 25 100, Sensor planar 100, Sensor planar 150
   yield: 95% * 98%  # UBM deposition yield * Dicing (thinning) yield
   
Sensor 3D selection:
   input: Sensor 3D 50 50, Sensor 3D 25 100
   output: Sensor 3D 50 50 passed, Sensor 3D 25 100 passed
   yield: 50% * 99.9%  # (production yield * probing yield)
   
Sensor planar selection:
   input: Sensor planar 100, Sensor planar 150
   output: Sensor planar 100 passed, Sensor planar 150 passed
   yield: 80% * 99.9% * 95%  # production yield * probing yield * diced sensor IV
   
Flip chip:
   input:
     - Sensor 3D 50 50 passed, Sensor 3D 25 100 passed, Sensor planar 100 passed, Sensor planar 150 passed, Sensor planar 150 passed
     - Itkpix chip passed
   output:
     - SC module 3D 50 50 bare, SC module 3D 25 100 bare, Quad module planar 100 bare, Quad module planar 150 bare, Quad module planar 150 ec bare
           
# L0 module building:
#    input: bare, module, 3D
#    output: populated, module, 3D
#    yield: 99.5%  # Flex attach to bare module yield
#    
# L0 module testing:
#    input: populated, module, 3D
#    output: populated, module, 3D, tested
#    yield: 82%
#    
# L1 module building:
#    input: bare, quad, module, thin
#    output: populated, quad, module, thin
#    yield: 99.5%  # Flex attach to bare module yield
#    
# L1 module testing:
#    input: populated, quad, module, thin
#    output: populated, quad, module, thin, tested
#    yield: 82%
#    
# OE module building:
#    input: bare, quad, module, endcap
#    output: populated, quad, module, endcap
#    yield: 99.5%  # Flex attach to bare module yield
#       
# OE module testing:
#    input: populated, quad, module, endcap
#    output: populated, quad, module, tested, endcap
#    yield: 82%
#    
# OB module building:
#    input:
#       - quad module planar 150 bare
#       - common quad hybrid
#    output: quad module planar 150 populated
#    yield: 99.5%  # Flex attach to bare module yield
#       
# OB module testing:
#    input: quad module planar 150 populated
#    output: quad module planar 150 tested
#    yield: 82%
#    
Installation:  # final installation of the detector
   input:
      - Quad module planar 100 bare
      - Quad module planar 150 bare  # FIXME
      - SC module 3D 50 50 bare
#      - Stave
